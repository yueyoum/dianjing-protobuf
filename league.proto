package Dianjing.protocol;

import "common.proto";
import "match.proto";
import "club.proto";

// 联赛小组信息
message League {
    message LeagueRank {
        // 排名
        required string league_club_id = 1;

        required int32 battle_times = 2;    // 已赛场数
        required int32 score = 3;           // 积分
        required int32 winning_rate = 4;    // 胜率
    }

    message LeagueEvent {
        // 定点分组比赛 一周14组，里面有7对比赛
        message LeaguePair {
            // 比赛对手
            required string pair_id = 1;
            required string league_club_one_id = 2;
            required string league_club_two_id = 3;
            required bool club_one_win = 4;
        }

        required int32 battle_at = 1; // UTC timestamp
        required bool finished = 2;   // 是否结束
        repeated LeaguePair pairs = 3;
    }

    message LeagueClub {
        required string league_club_id = 1;
        required Club club = 2;
    }


    required LeagueLevel level = 1;     // 联赛等级
    required int32 current_order=  2;   // 当前第几轮

    repeated LeagueClub clubs = 3;

    repeated LeagueRank ranks = 4;      // 排名
    repeated LeagueEvent events = 5;    // 场次
}


message LeagueNotify {
    required bytes session = 1;
    required League league = 2;
}



// 获取统计请求
message LeagueGetStatisticsRequest {
    required bytes session = 1;
    required string id = 2;
}


message LeagueGetStatisticsResponse {
    message LeagueStatistics {
        required int32 staff_id = 1;
        required int32 winning_rate_to_terran = 2;  // 对人族胜率
        required int32 winning_rate_to_zerg = 3;    // 对种族胜率
        required int32 winning_rate_to_protoss = 4; // 对神族胜率
    }


    required int32 ret = 1;
    required bytes session = 2;
    repeated LeagueStatistics statistics = 3;
}



// 查看一场比赛
message LeagueGetBattleLogRequest {
    required bytes session = 1;
    required string pair_id = 2;
}

message LeagueGetBattleLogResponse {
    required int32 ret = 1;
    required bytes session = 2;

    optional ClubMatch match_log = 3;
}

