package Dianjing.protocol;

import "common.proto";

// 联赛信息
message League {
    message LeagueRank {
        // 排名
        required string id = 1;
        required string name = 2;
        required ClubType tp = 3;

        required int32 battle_times = 4;    // 已赛场数
        required int32 score = 5;           // 积分
        required int32 winning_rate = 6;    // 胜率
    }

    message LeaguePair {
        // 比赛对手
        message Club {
            required string id = 1;
            required string name = 2;
            required ClubType tp = 3;
            required bool win = 4;  // 如果没有开始， 这里填充false
        }

        required string pair_id = 1;
        required Club club_one = 2;
        required Club club_two = 3;
        required int32 battle_at = 4; // UTC timestamp
    }


    required LeagueLevel level = 1;     // 联赛等级
    required int32 current_order=  2;   // 当前第几轮

    repeated LeagueRank ranks = 3;      // 排名
    repeated LeaguePair pairs = 4;      // 比赛排序
}


message LeagueNotify {
    required bytes session = 1;
    required League league = 2;
}




// 获取统计请求
message LeagueGetStatisticsRequest {
    required bytes session = 1;
    required string id = 2;
    required ClubType tp = 3;
}


message LeagueGetStatisticsResponse {
    message LeagueStatistics {
        required int32 staff_oid = 1;
        required int32 winning_rate_to_terran = 2;  // 对人族胜率
        required int32 winning_rate_to_zerg = 3;    // 对种族胜率
        required int32 winning_rate_to_protoss = 4; // 对神族胜率
    }


    required int32 ret = 1;
    required bytes session = 2;
    repeated LeagueStatistics statistics = 3;
}



// 查看一场比赛
message LeagueGetBattleLogRequest {
    required bytes session = 1;
    required string pair_id = 2;
}

message LeagueGetBattleLogResponse {
    message LeagueBattleLog {
        message LeagueStaff {
            required int32 staff_oid = 1;
            required int32 level = 2;
            required bool win = 3;
        }

        required LeagueStaff club_one_staff = 1;
        required LeagueStaff club_two_staff = 1;
    }


    required int32 ret = 1;
    required bytes session = 2;

    repeated LeagueBattleLog logs = 3;
}

